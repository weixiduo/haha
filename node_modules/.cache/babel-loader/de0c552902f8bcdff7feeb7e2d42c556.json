{"ast":null,"code":"import _asyncToGenerator from \"F:/vuexianmu/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"F:/vuexianmu/app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nexport default {\n  name: 'Trade',\n  data: function data() {\n    return {\n      //收集买家的留言信息\n      msg: \"\",\n      //订单号\n      orderId: \"\"\n    };\n  },\n  //生命周期函数:挂载完毕\n  mounted: function mounted() {\n    this.$store.dispatch(\"getUserAddress\");\n    this.$store.dispatch(\"getOrderInfo\");\n  },\n  computed: _objectSpread(_objectSpread({}, mapState({\n    addressInfo: function addressInfo(state) {\n      return state.trade.address;\n    },\n    orderInfo: function orderInfo(state) {\n      return state.trade.orderInfo;\n    }\n  })), {}, {\n    //将来提交订单最终选中地址\n    userDefaultAddress: function userDefaultAddress() {\n      //find:查找数组当中符合条件的元素返回，最为最终结果\n      return this.addressInfo.find(function (item) {\n        return item.isDefault == 1;\n      }) || {};\n    }\n  }),\n  //修改默认地址\n  changeDefault: function changeDefault(address, addressInfo) {\n    //全部的isDefault为零\n    addressInfo.forEach(function (item) {\n      return item.isDefault = 0;\n    });\n    address.isDefault = 1;\n  },\n  //提交订单\n  submitOrder: function submitOrder() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var tradeNo, data, result;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              //交易编码\n              tradeNo = _this.orderInfo.tradeNo; //其余的六个参数\n\n              data = {\n                consignee: _this.userDefaultAddress.consignee,\n                //最终收件人的名字\n                consigneeTel: _this.userDefaultAddress.phoneNum,\n                //最终收件人的手机号\n                deliveryAddress: _this.userDefaultAddress.fullAddress,\n                //收件人的地址\n                paymentWay: \"ONLINE\",\n                //支付方式\n                orderComment: _this.msg,\n                //买家的留言信息\n                orderDetailList: _this.orderInfo.detailArrayList //商品清单\n\n              }; //需要带参数的：tradeNo\n\n              _context.next = 4;\n              return _this.$API.reqSubmitOrder(tradeNo, data);\n\n            case 4:\n              result = _context.sent;\n\n              //提交订单成功\n              if (result.code == 200) {\n                _this.orderId = result.data; //路由跳转 + 路由传递参数\n\n                _this.$router.push('/pay?orderId=' + _this.orderId); //提交的订单失败\n\n              } else {\n                alert(result.data);\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiHA;AACA;EACAA,aADA;EAEAC,IAFA,kBAEA;IACA;MACA;MACAC,OAFA;MAGA;MACAC;IAJA;EAMA,CATA;EAUA;EACAC,OAXA,qBAWA;IACA;IACA;EACA,CAdA;EAeAC,0CACAC;IACAC;MAAA;IAAA,CADA;IAEAC;MAAA;IAAA;EAFA,EADA;IAKA;IACAC,kBANA,gCAMA;MACA;MACA;QAAA;MAAA;IACA;EATA,EAfA;EA0BA;EACAC,aA3BA,yBA2BAC,OA3BA,EA2BAJ,WA3BA,EA2BA;IACA;IACAA;MAAA;IAAA;IACAI;EACA,CA/BA;EAgCA;EACAC,WAjCA,yBAiCA;IAAA;;IAAA;MAAA;MAAA;QAAA;UAAA;YAAA;cACA;cACAC,OAFA,GAEA,eAFA,CAEAA,OAFA,EAGA;;cACAZ,IAJA,GAIA;gBACAa,6CADA;gBACA;gBACAC,+CAFA;gBAEA;gBACAC,qDAHA;gBAGA;gBACAC,oBAJA;gBAIA;gBACAC,uBALA;gBAKA;gBACAC,gDANA,CAMA;;cANA,CAJA,EAYA;;cAZA;cAAA,OAaA,wCAbA;;YAAA;cAaAC,MAbA;;cAcA;cACA;gBACA,4BADA,CAEA;;gBACA,oDAHA,CAIA;;cACA,CALA,MAKA;gBACAC;cACA;;YAtBA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EAuBA;AAxDA","names":["name","data","msg","orderId","mounted","computed","mapState","addressInfo","orderInfo","userDefaultAddress","changeDefault","address","submitOrder","tradeNo","consignee","consigneeTel","deliveryAddress","paymentWay","orderComment","orderDetailList","result","alert"],"sourceRoot":"src/pages/Trade","sources":["index.vue"],"sourcesContent":["<template>\n  <div class=\"trade-container\">\n    <h3 class=\"title\">填写并核对订单信息</h3>\n    <div class=\"content\">\n    <input\n      <h5 class=\"receive\">收件人信息</h5>\n       <div\n        class=\"address clearFix\"\n        v-for=\"(address, index) in addressInfo\"\n        :key=\"address.id\"\n      >\n        <span class=\"username \" :class=\"{ selected: address.isDefault == 1 }\">{{\n          address.consignee\n        }}</span>\n        <p @click=\"changeDefault(address, addressInfo)\">\n          <span class=\"s1\">{{ address.fullAddress }}</span>\n          <span class=\"s2\">{{ address.phoneNum }}</span>\n          <span class=\"s3\" v-show=\"address.isDefault == 1\">默认地址</span>\n        </p>\n      </div>\n      <div class=\"line\"></div>\n      <h5 class=\"pay\">支付方式</h5>\n      <div class=\"address clearFix\">\n        <span class=\"username selected\">在线支付</span>\n        <span class=\"username\" style=\"margin-left:5px;\">货到付款</span>\n\n      </div>\n      <div class=\"line\"></div>\n      <h5 class=\"pay\">送货清单</h5>\n      <div class=\"way\">\n        <h5>配送方式</h5>\n        <div class=\"info clearFix\">\n          <span class=\"s1\">天天快递</span>\n          <p>配送时间：预计8月10日（周三）09:00-15:00送达</p>\n        </div>\n      </div>\n      <div class=\"detail\">\n        <h5>商品清单</h5>\n        <ul class=\"list clearFix\">\n          <li>\n            <img src=\"./images/goods.png\" alt=\"\">\n          </li>\n          <li>\n            <p>\n              Apple iPhone 6s (A1700) 64G 玫瑰金色 移动联通电信4G手机硅胶透明防摔软壳 本色系列</p>\n            <h4>7天无理由退货</h4>\n          </li>\n          <li>\n            <h3>￥5399.00</h3>\n          </li>\n          <li>X1</li>\n          <li>有货</li>\n        </ul>\n        <ul class=\"list clearFix\">\n          <li>\n            <img src=\"./images/goods.png\" alt=\"\">\n          </li>\n          <li>\n            <p>\n              Apple iPhone 6s (A1700) 64G 玫瑰金色 移动联通电信4G手机硅胶透明防摔软壳 本色系列</p>\n            <h4>7天无理由退货</h4>\n          </li>\n          <li>\n            <h3>￥5399.00</h3>\n          </li>\n          <li>X1</li>\n          <li>有货</li>\n        </ul>\n      </div>\n      <div class=\"bbs\">\n        <h5>买家留言：</h5>\n        <textarea placeholder=\"建议留言前先与商家沟通确认\" class=\"remarks-cont\"></textarea>\n\n      </div>\n      <div class=\"line\"></div>\n      <div class=\"bill\">\n        <h5>发票信息：</h5>\n        <div>普通发票（电子） 个人 明细</div>\n        <h5>使用优惠/抵用</h5>\n      </div>\n    </div>\n    <div class=\"money clearFix\">\n      <ul>\n        <li>\n          <b><i>1</i>件商品，总商品金额</b>\n          <span>¥5399.00</span>\n        </li>\n        <li>\n          <b>返现：</b>\n          <span>0.00</span>\n        </li>\n        <li>\n          <b>运费：</b>\n          <span>0.00</span>\n        </li>\n      </ul>\n    </div>\n    <div class=\"trade\">\n      <div class=\"price\">应付金额:　<span>¥5399.00</span></div>\n      <div class=\"receiveInfo\">\n        寄送至:\n        <span>北京市昌平区宏福科技园综合楼6层</span>\n        收货人：<span>张三</span>\n        <span>15010658793</span>\n      </div>\n    </div>\n    <div class=\"sub clearFix\">\n      <router-link class=\"subBtn\" to=\"/pay\">提交订单</router-link>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {mapState} from 'vuex'\n  export default {\n    name: 'Trade',\n    data() {\n    return {\n      //收集买家的留言信息\n      msg: \"\",\n      //订单号\n      orderId: \"\",\n    };\n  },\n     //生命周期函数:挂载完毕\n  mounted() {\n    this.$store.dispatch(\"getUserAddress\");\n    this.$store.dispatch(\"getOrderInfo\");\n  },\n  computed: {\n    ...mapState({\n      addressInfo: (state) => state.trade.address,\n      orderInfo: (state) => state.trade.orderInfo,\n    }),\n     //将来提交订单最终选中地址\n    userDefaultAddress() {\n      //find:查找数组当中符合条件的元素返回，最为最终结果\n      return this.addressInfo.find((item) => item.isDefault == 1) || {};\n    },\n  },\n    //修改默认地址\n    changeDefault(address, addressInfo) {\n      //全部的isDefault为零\n      addressInfo.forEach((item) => (item.isDefault = 0));\n      address.isDefault = 1;\n    },\n    //提交订单\n    async submitOrder() {\n      //交易编码\n      let { tradeNo } = this.orderInfo;\n      //其余的六个参数\n      let data = {\n        consignee: this.userDefaultAddress.consignee, //最终收件人的名字\n        consigneeTel: this.userDefaultAddress.phoneNum, //最终收件人的手机号\n        deliveryAddress: this.userDefaultAddress.fullAddress, //收件人的地址\n        paymentWay: \"ONLINE\", //支付方式\n        orderComment: this.msg, //买家的留言信息\n        orderDetailList: this.orderInfo.detailArrayList, //商品清单\n      };\n      //需要带参数的：tradeNo\n      let result = await this.$API.reqSubmitOrder(tradeNo, data);\n      //提交订单成功\n      if (result.code == 200) {\n        this.orderId = result.data;\n        //路由跳转 + 路由传递参数\n        this.$router.push('/pay?orderId='+this.orderId);\n       //提交的订单失败\n      } else {\n        alert(result.data);\n      }\n    },\n  }\n</script>\n\n<style lang=\"less\" scoped>\n  .trade-container {\n    .title {\n      width: 1200px;\n      margin: 0 auto;\n      font-size: 14px;\n      line-height: 21px;\n    }\n\n    .content {\n      width: 1200px;\n      margin: 10px auto 0;\n      border: 1px solid rgb(221, 221, 221);\n      padding: 25px;\n      box-sizing: border-box;\n\n      .receive,\n      .pay {\n        line-height: 36px;\n        margin: 18px 0;\n      }\n\n      .address {\n        padding-left: 20px;\n        margin-bottom: 15px;\n\n        .username {\n          float: left;\n          width: 100px;\n          height: 30px;\n          line-height: 30px;\n          text-align: center;\n          border: 1px solid #ddd;\n          position: relative;\n        }\n\n        .username::after {\n          content: \"\";\n          display: none;\n          width: 13px;\n          height: 13px;\n          position: absolute;\n          right: 0;\n          bottom: 0;\n          background: url(./images/choosed.png) no-repeat;\n        }\n\n        .username.selected {\n          border-color: #e1251b;\n        }\n\n        .username.selected::after {\n          display: block;\n        }\n\n        p {\n          width: 610px;\n          float: left;\n          line-height: 30px;\n          margin-left: 10px;\n          padding-left: 5px;\n          cursor: pointer;\n\n          .s1 {\n            float: left;\n\n          }\n\n          .s2 {\n            float: left;\n            margin: 0 5px;\n          }\n\n          .s3 {\n            float: left;\n            width: 56px;\n            height: 24px;\n            line-height: 24px;\n            margin-left: 10px;\n            background-color: #878787;\n            color: #fff;\n            margin-top: 3px;\n            text-align: center;\n          }\n        }\n\n        p:hover {\n          background-color: #ddd;\n        }\n      }\n\n      .line {\n        height: 1px;\n        background-color: #ddd;\n      }\n\n      .way {\n        width: 1080px;\n        height: 110px;\n        background: #f4f4f4;\n        padding: 15px;\n        margin: 0 auto;\n\n        h5 {\n          line-height: 50px;\n        }\n\n        .info {\n          margin-top: 20px;\n\n          .s1 {\n            float: left;\n            border: 1px solid #ddd;\n            width: 120px;\n            height: 30px;\n            line-height: 30px;\n            text-align: center;\n            margin-right: 10px;\n          }\n\n          p {\n            line-height: 30px;\n          }\n        }\n      }\n\n      .detail {\n        width: 1080px;\n\n        background: #feedef;\n        padding: 15px;\n        margin: 2px auto 0;\n\n        h5 {\n          line-height: 50px;\n        }\n\n        .list {\n          display: flex;\n          justify-content: space-between;\n\n          li {\n            line-height: 30px;\n\n            p {\n\n              margin-bottom: 20px;\n            }\n\n            h4 {\n              color: #c81623;\n              font-weight: 400;\n            }\n\n            h3 {\n\n              color: #e12228;\n            }\n          }\n        }\n      }\n\n      .bbs {\n        margin-bottom: 15px;\n\n        h5 {\n          line-height: 50px;\n        }\n\n        textarea {\n          width: 100%;\n          border-color: #e4e2e2;\n          line-height: 1.8;\n          outline: none;\n          resize: none;\n        }\n      }\n\n      .bill {\n        h5 {\n          line-height: 50px;\n        }\n\n        div {\n          padding-left: 15px;\n        }\n      }\n    }\n\n    .money {\n      width: 1200px;\n      margin: 20px auto;\n\n      ul {\n        width: 220px;\n        float: right;\n\n        li {\n          line-height: 30px;\n          display: flex;\n          justify-content: space-between;\n\n          i {\n            color: red;\n          }\n        }\n      }\n    }\n\n    .trade {\n      box-sizing: border-box;\n      width: 1200px;\n      padding: 10px;\n      margin: 10px auto;\n      text-align: right;\n      background-color: #f4f4f4;\n      border: 1px solid #ddd;\n\n      div {\n        line-height: 30px;\n      }\n\n      .price span {\n        color: #e12228;\n        font-weight: 700;\n        font-size: 14px;\n      }\n\n      .receiveInfo {\n        color: #999;\n      }\n    }\n\n    .sub {\n      width: 1200px;\n      margin: 0 auto 10px;\n\n      .subBtn {\n        float: right;\n        width: 164px;\n        height: 56px;\n        font: 700 18px \"微软雅黑\";\n        line-height: 56px;\n        text-align: center;\n        color: #fff;\n        background-color: #e1251b;\n\n      }\n    }\n\n  }\n</style>"]},"metadata":{},"sourceType":"module"}